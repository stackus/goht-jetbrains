{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "GoHT",
  "patterns": [
    {
      "include": "source.go"
    },
    {
      "include": "#haml-template"
    },
    {
      "include": "#slim-template"
    },
    {
      "include": "#ego-template"
    }
  ],
  "repository": {
    "haml-template": {
      "begin": "^(@goht|@haml) (.+? {)",
      "end": "(^}$)",
      "beginCaptures": {
        "1": {
          "patterns": [
            {
              "include": "#goht-template-start"
            }
          ]
        },
        "2": {
          "patterns": [
            {
              "include": "source.go"
            }
          ]
        }
      },
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.end.bracket.curly.go"
        }
      },
      "patterns": [
        {
          "include": "#haml-template-content"
        }
      ],
      "name": "haml-template.goht"
    },
    "slim-template": {
      "begin": "^(@slim) (.+? {)",
      "end": "(^}$)",
      "beginCaptures": {
        "1": {
          "patterns": [
            {
              "include": "#goht-template-start"
            }
          ]
        },
        "2": {
          "patterns": [
            {
              "include": "source.go"
            }
          ]
        }
      },
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.end.bracket.curly.go"
        }
      },
      "patterns": [
        {
          "include": "#slim-template-content"
        }
      ],
      "name": "slim-template.goht"
    },
    "ego-template": {
      "begin": "^(@ego) (.+? {)",
      "end": "(^}$)",
      "beginCaptures": {
        "1": {
          "patterns": [
            {
              "include": "#goht-template-start"
            }
          ]
        },
        "2": {
          "patterns": [
            {
              "include": "source.go"
            }
          ]
        }
      },
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.end.bracket.curly.go"
        }
      },
      "patterns": [
        {
          "include": "#ego-template-content"
        }
      ],
      "name": "ego-template.goht"
    },
    "goht-template-start": {
      "match": ".+",
      "captures": {
        "0": {
          "name": "keyword.function.go"
        }
      }
    },
    "haml-template-content": {
      "patterns": [
        {
          "include": "#haml-doctype"
        },
        {
          "include": "#haml-tag"
        },
        {
          "include": "#filter-javascript"
        },
        {
          "include": "#filter-css"
        },
        {
          "include": "#haml-filter-text"
        },
        {
          "include": "#haml-inline-javascript"
        },
        {
          "include": "#haml-comment-line"
        },
        {
          "include": "#haml-comment-block"
        },
        {
          "include": "#go-line"
        },
        {
          "include": "#interpolated-go-line"
        },
        {
          "include": "#haml-string-line"
        }
      ]
    },
    "slim-template-content": {
      "patterns": [
        {
          "include": "#slim-doctype"
        },
        {
          "include": "#slim-tag"
        },
        {
          "include": "#filter-javascript"
        },
        {
          "include": "#filter-css"
        },
        {
          "include": "#slim-verbatim-text"
        },
        {
          "include": "#slim-inline-javascript"
        },
        {
          "include": "#haml-comment-line"
        },
        {
          "include": "#haml-comment-block"
        },
        {
          "include": "#go-line"
        },
        {
          "include": "#interpolated-go-line"
        },
        {
          "match": "\\s*(?![!%#.=-])(.+)$",
          "captures": {
            "1": {
              "patterns": [
                {
                  "include": "#interpolated-go"
                },
                {
                  "match": "(?!#\\{)([^{}]+?)(?<!\\})",
                  "name": "string.quoted.double.go"
                }
              ]
            }
          }
        }
      ]
    },
    "ego-template-content": {
      "patterns": [

        {
          "include": "#ego-comment"
        },
        {
          "include": "#ego-command"
        },
        {
          "include": "#ego-tag"
        },
        {
          "include": "text.html.basic"
        }
      ]
    },
    "haml-doctype": {
      "name": "meta.doctype.html",
      "match": "^\\s*(!!!)($|\\s.*)",
      "captures": {
        "1": {
          "name": "punctuation.definition.doctype.html"
        }
      }
    },
    "slim-doctype": {
      "name": "meta.doctype.html",
      "match": "^\\s*(doctype)($|\\s.*)",
      "captures": {
        "1": {
          "name": "punctuation.definition.doctype.html"
        }
      }
    },
    "haml-tag": {
      "name": "tag.html",
      "begin": "^\\s*(?:((%)([-\\w:]+))|(?=\\.|#))",
      "end": "$|(?!\\.|#|\\{|\\[|=|-|~|!=|/)",
      "captures": {
        "1": {
          "name": "punctuation.definition.tag.begin.html"
        },
        "2": {
          "name": "entity.name.tag.html"
        },
        "3": {
          "name": "entity.name.tag"
        }
      },
      "patterns": [
        {
          "include": "#tag-id"
        },
        {
          "include": "#tag-class"
        },
        {
          "include": "#tag-attributes"
        },
        {
          "include": "#haml-tag-object-ref"
        },
        {
          "include": "#interpolated-go-line"
        },
        {
          "name": "punctuation.terminator.tag.html",
          "match": "/"
        }
      ]
    },
    "slim-tag": {
      "name": "tag.html",
      "begin": "^\\s*(?:([a-zA-Z][-\\w:]*)|(?=\\.|#))",
      "end": "$|(?!\\.|#|\\{|\\[|=|-|~|!=|/)",
      "captures": {
        "1": {
          "name": "entity.name.tag.html"
        },
        "2": {
          "name": "punctuation.definition.tag.html"
        },
        "3": {
          "name": "entity.name.tag"
        }
      },
      "patterns": [
        {
          "include": "#tag-id"
        },
        {
          "include": "#tag-class"
        },
        {
          "include": "#tag-attributes"
        },
        {
          "include": "#interpolated-go-line"
        },
        {
          "name": "punctuation.terminator.tag.html",
          "match": "/"
        }
      ]
    },
    "filter-javascript": {
      "name": "js.html",
      "begin": "^(\\s*)(:)(javascript)",
      "end": "^(?!\\1\\s+|$\\n*)",
      "beginCaptures": {
        "2": {
          "name": "punctuation.definition.tag.html"
        },
        "3": {
          "name": "support.function.builtin.goht"
        }
      },
      "contentName": "meta.embedded.block.javascript",
      "patterns": [
        {
          "include": "source.js"
        },
        {
          "include": "#interpolated-go"
        }
      ]
    },
    "filter-css": {
      "begin": "^(\\s*)(:)(css)",
      "end": "^(?!\\1\\s+|$\\n*)",
      "beginCaptures": {
        "2": {
          "name": "punctuation.definition.tag.html"
        },
        "3": {
          "name": "support.function.builtin.goht"
        }
      },
      "contentName": "meta.embedded.block.css",
      "patterns": [
        {
          "include": "source.css"
        },
        {
          "include": "#interpolated-go"
        }
      ]
    },
    "haml-filter-text": {
      "begin": "^(\\s*)(:)(plain|escaped|preserve)$",
      "end": "^(?=\\1\\s+|$\\n*)",
      "beginCaptures": {
        "2": {
          "name": "punctuation.definition.tag.html"
        },
        "3": {
          "name": "support.function.builtin.goht"
        }
      },
      "patterns": [
        {
          "include": "text.plain"
        },
        {
          "include": "#interpolated-go"
        }
      ]
    },
    "haml-inline-javascript": {
      "name": "js.inline.html",
      "begin": "^(\\s*)%script",
      "end": "^(?!\\1\\s+|$\\n*)",
      "patterns": [
        {
          "include": "#tag-attributes"
        },
        {
          "include": "source.js"
        }
      ]
    },
    "slim-inline-javascript": {
      "name": "js.inline.html",
      "begin": "^(\\s*)script",
      "end": "^(?!\\1\\s+|$\\n*)",
      "patterns": [
        {
          "include": "#tag-attributes"
        },
        {
          "include": "source.js"
        }
      ]
    },
    "haml-comment-line": {
      "name": "comment.line.go",
      "match": "^(\\s*)(\\/\\[[^\\]].*?$\\n*)",
      "captures": {
        "1": {
          "name": "punctuation.section.comment.html"
        }
      }
    },
    "haml-comment-block": {
      "name": "comment.block.html",
      "begin": "^(\\s*)(\\-\\#|\\/|\\-\\s*\\/\\*+)",
      "end": "^(?!\\1\\s+|\\n)"
    },
    "interpolated-go": {
      "patterns": [
        {
          "match": "(?<!\\\\)#\\{(\\})",
          "captures": {
            "0": {
              "name": "punctuation.definition.begin.bracket.curly.go"
            },
            "1": {
              "name": "punctuation.definition.end.bracket.curly.go"
            }
          }
        },
        {
          "begin": "(?<!\\\\)#\\{",
          "end": "(\\})",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.begin.bracket.curly.go"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.end.bracket.curly.go"
            }
          },
          "patterns": [
            {
              "include": "#interpolated-value"
            }
          ]
        }
      ]
    },
    "interpolated-value": {
      "match": "(%[^\\s]+\\s)?[^\\}]+(?=\\})",
      "name": "variable.other.assignment.go.embedded.goht",
      "captures": {
        "0": {
          "name": "variable.other.assignment.go.embedded.goht"
        },
        "1": {
          "patterns": [
            {
              "include": "source.go#string_placeholder"
            }
          ]
        }
      }
    },
    "interpolated-go-line": {
      "name": "meta.line.go.interpolated.html",
      "begin": "!?=",
      "end": "$",
      "beginCaptures": {
        "0": {
          "name": "keyword.operator.go"
        }
      },
      "patterns": [
        {
          "include": "#commands"
        },
        {
          "include": "source.go"
        }
      ]
    },
    "go-line": {
      "name": "meta.line.go.html",
      "begin": "^\\s*!?(=|-)",
      "end": "$",
      "beginCaptures": {
        "0": {
          "name": "keyword.operator.go"
        }
      },
      "endCaptures": {
        "0": {
          "name": "keyword.operator.go"
        }
      },
      "contentName": "source.go.embedded.html",
      "patterns": [
        {
          "include": "#commands"
        },
        {
          "include": "source.go"
        }
      ]
    },
    "haml-string-line": {
      "patterns": [
        {
          "match": "\\s*(!)(.+)$",
          "captures": {
            "1": {
              "name": "punctuation.definition.tag.html"
            },
            "2": {
              "patterns": [
                {
                  "include": "#interpolated-go"
                },
                {
                  "match": "(?!#\\{)([^{}]+?)(?<!\\})",
                  "name": "string.quoted.double.go"
                }
              ]
            }
          }
        },
        {
          "match": "\\s*(?![!%#.=-])(.+)$",
          "captures": {
            "1": {
              "patterns": [
                {
                  "include": "#interpolated-go"
                },
                {
                  "match": "(?!#\\{)([^{}]+?)(?<!\\})",
                  "name": "string.quoted.double.go"
                }
              ]
            }
          }
        }
      ]
    },
    "slim-verbatim-text": {
      "begin": "^(\\s*)(\\|)",
      "end": "^(?!\\1\\s)",
      "contentName": "string.quoted.double.go",
      "beginCaptures": {
        "2": {
          "name": "keyword.operator.go"
        }
      },
      "patterns": [
        {
          "include": "#interpolated-go"
        }
      ]
    },
    "tag-id": {
      "name": "meta.selector.css",
      "match": "(#)([\\w-]+)",
      "captures": {
        "1": {
          "name": "punctuation.definition.tag.html"
        },
        "2": {
          "name": "constant.language.go"
        }
      }
    },
    "tag-class": {
      "name": "meta.selector.css",
      "match": "(\\.)([\\w\\-\\:]+)",
      "captures": {
        "1": {
          "name": "punctuation.definition.tag.html"
        },
        "2": {
          "name": "entity.other.attribute-name.class"
        }
      }
    },
    "tag-attributes": {
      "name": "meta.section.attributes.html",
      "begin": "(?<!\\#)\\{(?=.*(,|\\{|\\}|(\\#.*)|\\R)\\s*)",
      "end": "\\s*\\}(?!\\s*\\,)(?!\\#\\{.*\\})",
      "beginCaptures": {
        "0": {
          "name": "keyword.operator.go"
        }
      },
      "endCaptures": {
        "0": {
          "name": "keyword.operator.go"
        }
      },
      "patterns": [
        {
          "include": "#attribute-list"
        }
      ]
    },
    "attribute-list": {
      "patterns": [
        {
          "include": "#interpolated-go"
        },
        {
          "include": "#attribute-field-value"
        },
        {
          "include": "#attribute-field-name"
        },
        {
          "name": "punctuation.other.go",
          "match": "\\s*[:?,]\\s*"
        }
      ]
    },
    "attribute-field-name": {
      "patterns": [
        {
          "name": "entity.other.attribute-name.html",
          "match": "(?<![:?])\\s*([a-zA-Z_][\\-\\w]*)(?=\\s*(?:[:?,}]))"
        },
        {
          "name": "entity.other.attribute-name.html",
          "match": "(?<![:?])\\s*(?:((?<![\\\\])[`\"])((?:.(?!(?<![\\\\])[`\"]))*.?)[`\"])(?=\\s*(?:[:?}]))"
        },
        {
          "name": "entity.name.function.embedded.go",
          "match": "(?<![:?])\\s*@attributes(?=\\s*(?:[:?,}]))"
        }
      ]
    },
    "attribute-field-value": {
      "patterns": [
        {
          "match": "([:?])\\s*((?<![\\\\])[`\"])((?:.(?!(?<![\\\\])[`\"]))*.?)(\\2)",
          "captures": {
            "1": {
              "name": "punctuation.other.go"
            },
            "2": {
              "name": "string.quoted.double.go"
            },
            "3": {
              "name": "string.quoted.double.go"
            },
            "4": {
              "name": "string.quoted.double.go"
            }
          }
        }
      ]
    },
    "haml-tag-object-ref": {
      "begin": "(\\[)(?=.+(,|\\[|\\]|\\||(\\#.*))\\s*)",
      "beginCaptures": {
        "1": {
          "name": "punctuation.definition.begin.bracket.square.go"
        }
      },
      "end": "\\s*(\\])(?!.*(?!\\#\\[)\\])",
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.end.bracket.square.go"
        }
      },
      "name": "meta.section.object.html",
      "patterns": [
        {
          "include": "source.go"
        }
      ]
    },
    "commands": {
      "name": "entity.name.function.embedded.go",
      "match": "(?<=[=-])\\s*@(?:render|children|slot)(?:\\s|$)"
    },
    "ego-comment": {
      "patterns": [
        {
          "name": "comment.block.ego",
          "begin": "<(%#(?![^%]*?%>))",
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.tag.begin.html"
            },
            "1": {
              "name": "keyword.operator.go"
            }
          },
          "end": "([-$]?%)>",
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.tag.end.html"
            },
            "1": {
              "name": "keyword.operator.go"
            }
          },
          "contentName": "comment.block.html"
        },
        {
          "name": "comment.line.ego",
          "match": "(<)%#(.*?)[-$]?%(>)",
          "captures": {
            "0": { "name": "keyword.operator.go"},
            "1": { "name": "punctuation.definition.tag.begin.html"},
            "2": { "name": "comment.block.html" },
            "3": { "name": "punctuation.definition.tag.end.html" }
          }
        }
      ]
    },
    "ego-command": {
      "begin": "<(%@)(render|children|slot)\\b",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.tag.begin.html"
        },
        "1": {
          "name": "keyword.operator.go"
        },
        "2": {
          "name": "support.function.builtin.goht"
        }
      },
      "end": "([-$]?%)>",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.tag.end.html"
        },
        "1": {
          "name": "keyword.operator.go"
        }
      },
      "name": "comment.block.goht",
      "contentName": "comment.block.goht",
      "patterns": [
        {
          "include": "source.go"
        }
      ]
    },
    "ego-tag": {
      "name": "embedded.ego",
      "contentName": "source.go",
      "begin": "<(%[-=!]?)",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.tag.begin.html"
        },
        "1": {
          "name": "keyword.operator.go"
        }
      },
      "end": "(?!<%.*?)([-$]?%)>",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.tag.end.html"
        },
        "1": {
          "name": "keyword.operator.go"
        }
      },
      "patterns": [
        {
          "include": "source.go"
        }
      ]
    }
  },
  "scopeName": "source.goht"
}